SELECT data."Id", (SELECT CASE WHEN data."WindSpeed" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 1 OR critical."Sensor" = 0) ) ELSE data."WindSpeed" END), (SELECT CASE WHEN data."WindDirection" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 2 OR critical."Sensor" = 0) ) ELSE data."WindDirection" END), (SELECT CASE WHEN data."Pressure" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 3 OR critical."Sensor" = 0) ) ELSE data."Pressure" END), (SELECT CASE WHEN data."WeatherTemperature" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 4 OR critical."Sensor" = 0) ) ELSE data."WeatherTemperature" END), (SELECT CASE WHEN data."RailwayTemperature" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 5 OR critical."Sensor" = 0) ) ELSE data."RailwayTemperature" END), (SELECT CASE WHEN data."Humidity" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 7 OR critical."Sensor" = 0) ) ELSE data."Humidity" END), (SELECT CASE WHEN data."CouplingTemperature" IS NULL THEN ( SELECT critical."Value" FROM public."CriticalData" critical JOIN public."StationData" data on critical."StationDataId" = data."Id" JOIN public."StationInfo" info on data."StationInfoId" = info."Id" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b' AND critical."Solved" = False AND (critical."Sensor" = 6 OR critical."Sensor" = 0) ) ELSE data."CouplingTemperature" END), data."Time", data."StationInfoId"  FROM public."StationData" data JOIN public."StationInfo" info ON info."Id" = data."StationInfoId" INNER JOIN (SELECT MAX(newData."Time") "Time", "StationInfoId" FROM public."StationData" newData GROUP BY "StationInfoId" ORDER BY "Time" DESC) AS sortedData ON data."StationInfoId" = sortedData."StationInfoId" AND data."Time" = sortedData."Time" WHERE info."StationId" = '3d3401da-400e-1f21-11a9-0c4653631b2b'